name: Trigger Webhook for publishing package to pub.dev on Tag Creation

on:
  push:
    tags:
      - '*'

jobs:
  trigger-webhook:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Send cURL request
        env:
          WEBHOOK_URL: ${{ secrets.SD_PUB_DEV_PUBLISHING_URL }}
          AUTH_TOKEN: ${{ secrets.SD_PUB_DEV_PUBLISHING_AUTH_TOKEN }}
        run: |
          echo "Webhook Url logging: $WEBHOOK_URL"
          curl --manual--location --request POST 
          curl -X POST "$WEBHOOK_URL" \      
          -H "Authorization: $AUTH_TOKEN"
